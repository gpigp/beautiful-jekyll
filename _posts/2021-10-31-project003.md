---
layout: post
title: Project003
subtitle: SNP and INDEL calling
cover-img: /assets/img/path.jpg
<!-- thumbnail-img: https://gpigp.github.io/taehyun/assets/post1-img/project001-cover.png -->
tags: [SNP, INDEL, Marmoset, Stanford, GATK4, BWA]

published: true
---

Call SNPs and INDELs
============================

#### *docker에서 진행된 것입니다*

1. reference와 standard paired-end whole-genome sequencing data 다운

    * reference 다운    
    https://hgdownload.soe.ucsc.edu/goldenPath/calJac4/bigZips/ 2020년 marmoset data
    
    

        reference는 calJac4.fa.gz이며 우클릭 하여 링크 주소 복사
        > wget 링크주소

         ```
         wget https://hgdownload.soe.ucsc.edu/goldenPath/calJac4/bigZips/calJac4.fa.gz
         ```
    * standard paried-end whole- genome sequencing data 다운    
    https://www.ncbi.nlm.nih.gov/sra/?term=SRP141443 
    
         SRR7050660 다운
    
         ```
         wget https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR7050660/SRR7050660
         ```
         다운 시간은 reference는 얼마 안걸렸지만 SRR7050660은 6시간 정도 걸렸던것 같습니다.  
  
  
2. 다운 받은 파일 압축 풀기   

    * calJac4.fa.gz 압축 풀기
       
       ```
       gzip -d calJac4.fa.gz
       ```
       calJac4.fa  fasta파일이 생성된다.
  
  
    * SRR7050660 압축 풀기
      
      SRR7050660을 SRA 툴을 사용하여 압축 해제시키면 SRR7050660_1.fastq, SRR7050660_2.fastq로 나뉘어진다.
      https://github.com/ncbi/sra-tools/wiki/02.-Installing-SRA-Toolkit 이 사이트에서 확인 할 수 있다.
      
      먼저 두개 파일로 분리시키기 위해 fastq-dump를 사용해야하는데, SRA Toolkit이 필요합니다.
      #### *각자 환경에 맞게 설치 바랍니다.*
      
      - SRA Toolkit 파일 다운
      
          ```
          wget --output-document sratoolkit.tar.gz http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-ubuntu64.tar.gz
          ```
      
      - 다운받은 tar 압축 풀기
      
          ```
          tar -vxzf sratoolkit.tar.gz
          ```
          
      - 환경변수 설정
      
          ```
          export PATH=$PATH:$PWD/sratoolkit.2.4.0-1.mac64/bin
          ```
      
      - 설치 제대로 됐는지 확인
      
          ```
          which fastq-dump
          ```    
          ###### *아무것도 안뜬다면 설치가 안된 것.*        
        
        
      여기까지가 SRA Toolkit 다운입니다.    
      
      
      #fastq-dump -I --split-files 파일이름    
      파일이름_1.fastq, 파일이름_2.fastq로 분리된다.
      
      ```
      fastq-dump -I --split-files SRR7050660
      ```
      

3. 
